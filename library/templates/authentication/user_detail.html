{% extends 'base.html' %}

{% block title %}User Details - {{ user_to_view.email }}{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1 style="color: #333;">
            👤 User Details
            {% if is_own_profile %}
                <span style="color: #007bff; font-size: 0.8em;">(Your Profile)</span>
            {% endif %}
        </h1>
        <div>
            {% if user.is_librarian %}
                <a href="{% url 'all_users' %}" class="btn btn-secondary">← Back to All Users</a>
            {% endif %}
            <a href="{% url 'visitor_account' %}" class="btn btn-secondary">← Dashboard</a>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
            <h3 style="color: #333; margin-bottom: 1rem; border-bottom: 2px solid #007bff; padding-bottom: 0.5rem;">
                📋 Basic Information
            </h3>
            <div style="display: grid; gap: 0.8rem;">
                <div>
                    <strong>User ID:</strong> #{{ user_to_view.id }}
                </div>
                <div>
                    <strong>Email:</strong> {{ user_to_view.email }}
                </div>
                <div>
                    <strong>Full Name:</strong>
                    {{ user.first_name }} {{ user.middle_name }} {{ user.last_name }}
                </div>
                <div>
                    <strong>First Name:</strong> {{ user_to_view.first_name|default:"—" }}
                </div>
                <div>
                    <strong>Middle Name:</strong> {{ user_to_view.middle_name|default:"—" }}
                </div>
                <div>
                    <strong>Last Name:</strong> {{ user_to_view.last_name|default:"—" }}
                </div>
            </div>
        </div>

        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
            <h3 style="color: #333; margin-bottom: 1rem; border-bottom: 2px solid #28a745; padding-bottom: 0.5rem;">
                ⚙️ Account Settings
            </h3>
            <div style="display: grid; gap: 0.8rem;">
                <div>
                    <strong>Role:</strong>
                    {% if user_to_view.is_librarian %}
                        <span style="background: #7b1fa2; color: white; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.9rem;">
                            👨‍💼 Librarian
                        </span>
                    {% else %}
                        <span style="background: #388e3c; color: white; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.9rem;">
                            📖 Visitor
                        </span>
                    {% endif %}
                </div>
                <div>
                    <strong>Status:</strong>
                    {% if user_to_view.is_active %}
                        <span style="color: #28a745; font-weight: bold;">● Active</span>
                    {% else %}
                        <span style="color: #dc3545; font-weight: bold;">● Inactive</span>
                    {% endif %}
                </div>
                <div>
                    <strong>Staff Access:</strong> {{ user_to_view.is_staff|yesno:"Yes,No" }}
                </div>
                <div>
                    <strong>Superuser:</strong> {{ user_to_view.is_superuser|yesno:"Yes,No" }}
                </div>
            </div>
        </div>
    </div>

    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem;">
        <h3 style="color: #333; margin-bottom: 1rem; border-bottom: 2px solid #ffc107; padding-bottom: 0.5rem;">
            🕒 Timeline
        </h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <div>
                <strong>Account Created:</strong><br>
                <span style="color: #666;">{{ user_to_view.created_at|date:"F d, Y \a\t H:i" }}</span>
            </div>
            <div>
                <strong>Last Updated:</strong><br>
                <span style="color: #666;">{{ user_to_view.updated_at|date:"F d, Y \a\t H:i" }}</span>
            </div>
        </div>
    </div>

    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
        <h3 style="color: #333; margin-bottom: 1rem; border-bottom: 2px solid #dc3545; padding-bottom: 0.5rem;">
            📊 Activity Statistics
        </h3>
        <div style="color: #666; font-style: italic;">
            📝 Order statistics will be displayed here once the Orders module is implemented.
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem; opacity: 0.5;">
            <div style="text-align: center; padding: 1rem; background: white; border-radius: 5px;">
                <h4 style="margin: 0; color: #007bff;">0</h4>
                <p style="margin: 0; font-size: 0.9rem;">Total Orders</p>
            </div>
            <div style="text-align: center; padding: 1rem; background: white; border-radius: 5px;">
                <h4 style="margin: 0; color: #28a745;">0</h4>
                <p style="margin: 0; font-size: 0.9rem;">Completed</p>
            </div>
            <div style="text-align: center; padding: 1rem; background: white; border-radius: 5px;">
                <h4 style="margin: 0; color: #ffc107;">0</h4>
                <p style="margin: 0; font-size: 0.9rem;">Active</p>
            </div>
        </div>
    </div>

    {% if user.is_librarian and not is_own_profile %}
    <div style="margin-top: 2rem; padding: 1rem; background: #fff3cd; border-radius: 8px;">
        <strong>Administrative Actions:</strong>
        <div style="margin-top: 1rem;">
            <button class="btn btn-secondary" style="margin-right: 0.5rem;" onclick="alert('Feature coming soon!')">
                📝 Edit User
            </button>
            {% if user_to_view.is_active %}
                <button class="btn btn-danger" onclick="alert('Feature coming soon!')">
                    🚫 Deactivate User
                </button>
            {% else %}
                <button class="btn btn-primary" onclick="alert('Feature coming soon!')">
                    ✅ Activate User
                </button>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}